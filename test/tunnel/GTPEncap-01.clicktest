%info
Tests GTPEncap/GTPDecap

%require
click-buildtool provides tunnel

%script
click -e "
InfiniteSource(LIMIT 1, STOP true, DATA \<45000054584b00003f019de1c0a8010ac0a803220000e60114c4255b0f9eb759000000005314070000000000101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f3031323334353637>)
  -> GTPEncap(22)
  -> UDPIPEncap(192.168.4.91, 37076, 192.168.4.20, 2152)
  -> Print(GTP,-1)
  -> Strip(28)
  -> GTPDecap
  -> Print(DECAPED,-1)
  -> p :: ToIPSummaryDump(-, FIELDS aggregate);
"

%expect stdout
!IPSummaryDump 1.3
!data aggregate
22

%expect stderr
GTP:  120 | 45000078 00000000 fa1136b5 c0a8045b c0a80414 90d40868 00640000 30ff0054 00000016 45000054 584b0000 3f019de1 c0a8010a c0a80322 0000e601 14c4255b 0f9eb759 00000000 53140700 00000000 10111213 14151617 18191a1b 1c1d1e1f 20212223 24252627 28292a2b 2c2d2e2f 30313233 34353637
DECAPED:   84 | 45000054 584b0000 3f019de1 c0a8010a c0a80322 0000e601 14c4255b 0f9eb759 00000000 53140700 00000000 10111213 14151617 18191a1b 1c1d1e1f 20212223 24252627 28292a2b 2c2d2e2f 30313233 34353637


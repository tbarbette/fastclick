%require
click-buildtool provides flow flow-dynamic ctx TCPReflector

%script
click CONFIG --simtime

%file CONFIG
FromIPSummaryDump(RX, STOP true, CHECKSUM true, TIMING true)
-> Print("IN",-1)
-> CTXManager(VERBOSE 1, CONTEXT NONE)
~> IPIn
-> IPPrint(RX)
-> tcpin_rx2 :: TCPIn(RETURNNAME tcpin_tx2, VERBOSE 1)
-> IPPrint(RXTCP)
-> WordMatcher(WORD is, MODE REMOVE, ALL true)
-> Print("OUTR",-1)
-> IPPrint("OUTR")
-> to_rx :: TCPOut
-> IPOut
-> out_rx :: Print("OUT",-1)
-> IPPrint("OUT")
-> tee  :: Tee -> FlowStack(RELEASE true) -> ToIPSummaryDump(REMOVE, FIELDS wire_len tcp_seq tcp_ack tcp_flags payload);

to_rx[1] -> out_rx;

tee[1]
-> FlowStack(RELEASE false)
-> TCPReflector(STRIP_PAYLOAD true, RAND_SEQ false)
-> CTXManager(VERBOSE 0, CONTEXT NONE)
-> Print("TX",-1)
~> IPIn
-> IPPrint(TX)
-> tcpin_tx2 :: TCPIn(RETURNNAME tcpin_rx2, VERBOSE 1)
-> to_tx :: TCPOut
-> IPOut
-> IPPrint(TXOUT)
-> Discard


%file RX
!data timestamp src sport dst dport proto tcp_seq tcp_ack tcp_flags payload
1 18.26.4.44 2222 18.26.4.44 22 T 1000    0 S
3 18.26.4.44 2222 18.26.4.44 22 T 1001 1001001 A
#Unordered on purpose
4 18.26.4.44 2222 18.26.4.44 22 T 1009 1001001 . at
5 18.26.4.44 2222 18.26.4.44 22 T 1001 1001001 . thisisan
5 18.26.4.44 2222 18.26.4.44 22 T 1001 1001001 . thisisan
6 18.26.4.44 2222 18.26.4.44 22 T 1011 1001001 . tack
7 18.26.4.44 2222 18.26.4.44 22 T 1015 1001001 F

8 18.26.4.44 2322 18.26.4.45 22 T 1000    0 S
9 18.26.4.44 2322 18.26.4.45 22 T 1001 1001001 A
10 18.26.4.44 2322 18.26.4.45 22 T 1001 1001001 . thi
11 18.26.4.44 2322 18.26.4.45 22 T 1004 1001001 . sais
12 18.26.4.44 2322 18.26.4.45 22 T 1008 1001001 . acat
13 18.26.4.44 2322 18.26.4.45 22 T 1012 1001001 . is
14 18.26.4.44 2322 18.26.4.45 22 T 1014 1001001 . beautifull
15 18.26.4.44 2322 18.26.4.45 22 T 1024 1001001 F


%expect REMOVE
!IPSummaryDump 1.3
!data wire_len tcp_seq tcp_ack tcp_flags payload
40 1000 0 S ""
40 1001 1001001 A ""
44 1001 1001001 . "than"
42 1005 1001001 . "at"
44 1007 1001001 . "tack"
40 1011 1001001 F ""
40 1000 0 S ""
40 1001 1001001 A ""
40 1001001 1004 A ""
42 1001 1001001 . "th"
41 1003 1001001 . "a"
44 1004 1001001 . "acat"
40 1001001 1014 A ""
40 1008 1001001 . ""
50 1008 1001001 . "beautifull"
40 1018 1001001 F ""

%expect stderr

CONFIG:6: While configuring 'tcpin_rx2 :: TCPIn':
  warning: TCPIn has only one output and I could not find a TCPRetransmitter. TCP retransmissions will be lost and not forwarded
CONFIG:26: While configuring 'tcpin_tx2 :: TCPIn':
  warning: TCPIn has only one output and I could not find a TCPRetransmitter. TCP retransmissions will be lost and not forwarded
CONFIG:8: While configuring 'WordMatcher@8 :: WordMatcher':
  warning: Element not optimized for ALL
Placing  context_flowcontextdispatcher_2 :: FlowContextDispatcher at [4-7]
Placing  context_flowcontextdispatcher_20 :: FlowContextDispatcher at [4-7]
Placing  tcpin_rx2 :: TCPIn at [8-79]
Placing  tcpin_tx2 :: TCPIn at [8-79]
Placing  WordMatcher@8 :: WordMatcher at [80-95]
Adding element IPIn@22 :: IPIn as predecessor of tcpin_tx2 :: TCPIn
Adding element tcpin_tx2 :: TCPIn as predecessor of to_tx :: TCPOut
Adding element to_tx :: TCPOut as predecessor of IPOut@26 :: IPOut
Adding element IPIn@4 :: IPIn as predecessor of tcpin_rx2 :: TCPIn
Adding element tcpin_rx2 :: TCPIn as predecessor of WordMatcher@8 :: WordMatcher
Adding element WordMatcher@8 :: WordMatcher as predecessor of to_rx :: TCPOut
Adding element to_rx :: TCPOut as predecessor of IPOut@12 :: IPOut
Adding element to_rx :: TCPOut as predecessor of IPIn@22 :: IPIn
Adding element IPOut@12 :: IPOut as predecessor of IPIn@22 :: IPIn
to_tx :: TCPOut Flow resizing support enabled
to_rx :: TCPOut Flow resizing support enabled
Warning : Sub-table optimization not supported as of now.
Warning : Sub-table optimization not supported as of now.
Table of CTXManager@3 after optimization :
---
9/FF (TWOCASE, 1 children)
|-> 6
|  12/FFFFFFFF (HASH-2053, 0 children, dynamic)
|  |-> DEFAULT
|  |  16/FFFFFFFF (HASH-2053, 0 children, dynamic)
|  |  |-> DEFAULT
|  |  |  20/FFFFFFFF (HASH-2053, 0 children, dynamic)
|  |  |  |-> DEFAULT 4294967295 UC:{{0|1}} ED:0 (data ffffffff0000000000000000000000000000000000000000000000000000)
|-> DEFAULT 0 UC:{{0|1}} ED:1 (data 00000000ffffffff00000000000000000000000000000000000000000000)
---
IN:   40 | 45000028 00000000 64062a45 121a042c 121a042c 08ae0016 000003e8 00000000 50020000 76ab0000
RX: 1.000000: 18.26.4.44.2222 > 18.26.4.44.22: S 1000:1001(1,40,40) win 0
RXTCP: 1.000000: 18.26.4.44.2222 > 18.26.4.44.22: S 1000:1001(1,40,40) win 0
OUTR:   40 | 45000028 00000000 64062a45 121a042c 121a042c 08ae0016 000003e8 00000000 50020000 76ab0000
OUTR: 1.000000: 18.26.4.44.2222 > 18.26.4.44.22: S 1000:1001(1,40,40) win 0
Map SEQ 1000 -> 1000
OUT:   40 | 45000028 00000000 64062a45 121a042c 121a042c 08ae0016 000003e8 00000000 50020000 76ab0000
OUT: 1.000000: 18.26.4.44.2222 > 18.26.4.44.22: S 1000:1001(1,40,40) win 0
TX:   40 | 45000028 00000000 fa069444 121a042c 121a042c 001608ae 000f4628 000003e9 5012f000 40620000
TX: 1.000000: 18.26.4.44.22 > 18.26.4.44.2222: S 1001000:1001001(1,40,40) ack 1001 win 61440
Map ACK 1001 -> 1001
Map SEQ 1001000 -> 1001000
TXOUT: 1.000000: 18.26.4.44.22 > 18.26.4.44.2222: S 1001000:1001001(1,40,40) ack 1001 win 61440
IN:   40 | 45000028 00000000 64062a45 121a042c 121a042c 08ae0016 000003e9 000f4629 50100000 30640000
RX: 3.000000: 18.26.4.44.2222 > 18.26.4.44.22: . 1001:1001(0,40,40) ack 1001001 win 0
Map ACK 1001001 -> 1001001
RXTCP: 3.000000: 18.26.4.44.2222 > 18.26.4.44.22: . 1001:1001(0,40,40) ack 1001001 win 0
OUTR:   40 | 45000028 00000000 64062a45 121a042c 121a042c 08ae0016 000003e9 000f4629 50100000 30640000
OUTR: 3.000000: 18.26.4.44.2222 > 18.26.4.44.22: . 1001:1001(0,40,40) ack 1001001 win 0
Map SEQ 1001 -> 1001
OUT:   40 | 45000028 00000000 64062a45 121a042c 121a042c 08ae0016 000003e9 000f4629 50100000 30640000
OUT: 3.000000: 18.26.4.44.2222 > 18.26.4.44.22: . 1001:1001(0,40,40) ack 1001001 win 0
Unknown ignored
IN:   42 | 4500002a 00000000 64062a43 121a042c 121a042c 08ae0016 000003f1 000f4629 50000000 cef50000 6174
RX: 4.000000: 18.26.4.44.2222 > 18.26.4.44.22: . 1009:1011(2,42,42) win 0
Flow is unordered... Awaiting 1001, have 1009
IN:   48 | 45000030 00000000 64062a3d 121a042c 121a042c 08ae0016 000003e9 000f4629 50000000 87ae0000 74686973 6973616e
RX: 5.000000: 18.26.4.44.2222 > 18.26.4.44.22: . 1001:1009(8,48,48) win 0
Now in order 1009 1009 !
RXTCP: 5.000000: 18.26.4.44.2222 > 18.26.4.44.22: . 1001:1009(8,48,48) win 0
RXTCP: 4.000000: 18.26.4.44.2222 > 18.26.4.44.22: . 1009:1011(2,42,42) win 0
Adding modification at seq 1001, pos in content 2, seq+pos 1003, removing 2 bytes
Adding modification at seq 1001, pos in content 2, seq+pos 1003, removing 2 bytes
OUTR:   44 | 45000030 00000000 64062a3d 121a042c 121a042c 08ae0016 000003e9 000f4629 50000000 87ae0000 7468616e
OUTR:   42 | 4500002a 00000000 64062a43 121a042c 121a042c 08ae0016 000003f1 000f4629 50000000 cef50000 6174
OUTR: 5.000000: 18.26.4.44.2222 > 18.26.4.44.22: . 1001:1009(8,44,48) win 0
OUTR: 4.000000: 18.26.4.44.2222 > 18.26.4.44.22: . 1009:1011(2,42,42) win 0
Map SEQ 1001 -> 1001
Map SEQ 1009 -> 1005
OUT:   44 | 4500002c 00000000 64062a41 121a042c 121a042c 08ae0016 000003e9 000f4629 50000000 5a990000 7468616e
OUT:   42 | 4500002a 00000000 64062a43 121a042c 121a042c 08ae0016 000003ed 000f4629 50000000 cef90000 6174
OUT: 5.000000: 18.26.4.44.2222 > 18.26.4.44.22: . 1001:1005(4,44,44) win 0
OUT: 4.000000: 18.26.4.44.2222 > 18.26.4.44.22: . 1005:1007(2,42,42) win 0
TX:   40 | 45000028 00000000 fa069444 121a042c 121a042c 001608ae 000f4629 000003ed 5010f000 405f0000
TX:   40 | 45000028 00000000 fa069444 121a042c 121a042c 001608ae 000f4629 000003ef 5010f000 405d0000
TX: 5.000000: 18.26.4.44.22 > 18.26.4.44.2222: . 1001001:1001001(0,40,40) ack 1005 win 61440
TX: 4.000000: 18.26.4.44.22 > 18.26.4.44.2222: . 1001001:1001001(0,40,40) ack 1007 win 61440
Map ACK 1005 -> 1009
Map ACK 1007 -> 1011
Map SEQ 1001001 -> 1001001
Map SEQ 1001001 -> 1001001
TXOUT: 5.000000: 18.26.4.44.22 > 18.26.4.44.2222: . 1001001:1001001(0,40,40) ack 1009 win 61440
TXOUT: 4.000000: 18.26.4.44.22 > 18.26.4.44.2222: . 1001001:1001001(0,40,40) ack 1011 win 61440
IN:   48 | 45000030 00000000 64062a3d 121a042c 121a042c 08ae0016 000003e9 000f4629 50000000 87ae0000 74686973 6973616e
RX: 5.000000: 18.26.4.44.2222 > 18.26.4.44.22: . 1001:1009(8,48,48) win 0
Flow is unordered... Awaiting 1011, have 1001
Killed retransmission
IN:   44 | 4500002c 00000000 64062a41 121a042c 121a042c 08ae0016 000003f3 000f4629 50000000 58990000 7461636b
RX: 6.000000: 18.26.4.44.2222 > 18.26.4.44.22: . 1011:1015(4,44,44) win 0
RXTCP: 6.000000: 18.26.4.44.2222 > 18.26.4.44.22: . 1011:1015(4,44,44) win 0
OUTR:   44 | 4500002c 00000000 64062a41 121a042c 121a042c 08ae0016 000003f3 000f4629 50000000 58990000 7461636b
OUTR: 6.000000: 18.26.4.44.2222 > 18.26.4.44.22: . 1011:1015(4,44,44) win 0
Map SEQ 1011 -> 1007
OUT:   44 | 4500002c 00000000 64062a41 121a042c 121a042c 08ae0016 000003ef 000f4629 50000000 589d0000 7461636b
OUT: 6.000000: 18.26.4.44.2222 > 18.26.4.44.22: . 1007:1011(4,44,44) win 0
TX:   40 | 45000028 00000000 fa069444 121a042c 121a042c 001608ae 000f4629 000003f3 5010f000 40590000
TX: 6.000000: 18.26.4.44.22 > 18.26.4.44.2222: . 1001001:1001001(0,40,40) ack 1011 win 61440
Map ACK 1011 -> 1015
Map SEQ 1001001 -> 1001001
TXOUT: 6.000000: 18.26.4.44.22 > 18.26.4.44.2222: . 1001001:1001001(0,40,40) ack 1015 win 61440
IN:   40 | 45000028 00000000 64062a45 121a042c 121a042c 08ae0016 000003f7 000f4629 50010000 30650000
RX: 7.000000: 18.26.4.44.2222 > 18.26.4.44.22: F 1015:1016(1,40,40) win 0
RXTCP: 7.000000: 18.26.4.44.2222 > 18.26.4.44.22: F 1015:1016(1,40,40) win 0
OUTR:   40 | 45000028 00000000 64062a45 121a042c 121a042c 08ae0016 000003f7 000f4629 50010000 30650000
OUTR: 7.000000: 18.26.4.44.2222 > 18.26.4.44.22: F 1015:1016(1,40,40) win 0
Map SEQ 1015 -> 1011
OUT:   40 | 45000028 00000000 64062a45 121a042c 121a042c 08ae0016 000003f3 000f4629 50010000 30690000
OUT: 7.000000: 18.26.4.44.2222 > 18.26.4.44.22: F 1011:1012(1,40,40) win 0
TX:   40 | 45000028 00000000 fa069444 121a042c 121a042c 001608ae 000f4629 000003f4 5011f000 40570000
TX: 7.000000: 18.26.4.44.22 > 18.26.4.44.2222: F 1001001:1001002(1,40,40) ack 1012 win 61440
Map ACK 1012 -> 1016
Map SEQ 1001001 -> 1001001
TXOUT: 7.000000: 18.26.4.44.22 > 18.26.4.44.2222: F 1001001:1001002(1,40,40) ack 1016 win 61440
IN:   40 | 45000028 00000000 64062a44 121a042c 121a042d 09120016 000003e8 00000000 50020000 76460000
RX: 8.000000: 18.26.4.44.2322 > 18.26.4.45.22: S 1000:1001(1,40,40) win 0
RXTCP: 8.000000: 18.26.4.44.2322 > 18.26.4.45.22: S 1000:1001(1,40,40) win 0
OUTR:   40 | 45000028 00000000 64062a44 121a042c 121a042d 09120016 000003e8 00000000 50020000 76460000
OUTR: 8.000000: 18.26.4.44.2322 > 18.26.4.45.22: S 1000:1001(1,40,40) win 0
Map SEQ 1000 -> 1000
OUT:   40 | 45000028 00000000 64062a44 121a042c 121a042d 09120016 000003e8 00000000 50020000 76460000
OUT: 8.000000: 18.26.4.44.2322 > 18.26.4.45.22: S 1000:1001(1,40,40) win 0
TX:   40 | 45000028 00000000 fa069443 121a042d 121a042c 00160912 000f4628 000003e9 5012f000 3ffd0000
TX: 8.000000: 18.26.4.45.22 > 18.26.4.44.2322: S 1001000:1001001(1,40,40) ack 1001 win 61440
Map ACK 1001 -> 1001
Map SEQ 1001000 -> 1001000
TXOUT: 8.000000: 18.26.4.45.22 > 18.26.4.44.2322: S 1001000:1001001(1,40,40) ack 1001 win 61440
IN:   40 | 45000028 00000000 64062a44 121a042c 121a042d 09120016 000003e9 000f4629 50100000 2fff0000
RX: 9.000000: 18.26.4.44.2322 > 18.26.4.45.22: . 1001:1001(0,40,40) ack 1001001 win 0
Map ACK 1001001 -> 1001001
RXTCP: 9.000000: 18.26.4.44.2322 > 18.26.4.45.22: . 1001:1001(0,40,40) ack 1001001 win 0
OUTR:   40 | 45000028 00000000 64062a44 121a042c 121a042d 09120016 000003e9 000f4629 50100000 2fff0000
OUTR: 9.000000: 18.26.4.44.2322 > 18.26.4.45.22: . 1001:1001(0,40,40) ack 1001001 win 0
Map SEQ 1001 -> 1001
OUT:   40 | 45000028 00000000 64062a44 121a042c 121a042d 09120016 000003e9 000f4629 50100000 2fff0000
OUT: 9.000000: 18.26.4.44.2322 > 18.26.4.45.22: . 1001:1001(0,40,40) ack 1001001 win 0
Unknown ignored
IN:   43 | 4500002b 00000000 64062a41 121a042c 121a042d 09120016 000003e9 000f4629 50000000 52a30000 746869
RX: 10.000000: 18.26.4.44.2322 > 18.26.4.45.22: . 1001:1004(3,43,43) win 0
RXTCP: 10.000000: 18.26.4.44.2322 > 18.26.4.45.22: . 1001:1004(3,43,43) win 0
OUT:   40 | 45000028 00004000 ff064f43 121a042d 121a042c 00160912 000f4629 000003ec 5010f000 3ffb0000
OUT: 0.000000: 18.26.4.45.22 > 18.26.4.44.2322: . 1001001:1001001(0,40,40) ack 1004 win 61440
Unknown ignored
IN:   44 | 4500002c 00000000 64062a40 121a042c 121a042d 09120016 000003ec 000f4629 50000000 53330000 73616973
RX: 11.000000: 18.26.4.44.2322 > 18.26.4.45.22: . 1004:1008(4,44,44) win 0
RXTCP: 11.000000: 18.26.4.44.2322 > 18.26.4.45.22: . 1004:1008(4,44,44) win 0
Adding modification at seq 1001, pos in content 2, seq+pos 1003, removing 1 bytes
Adding modification at seq 1004, pos in content 0, seq+pos 1004, removing 1 bytes
Adding modification at seq 1004, pos in content 1, seq+pos 1005, removing 2 bytes
OUTR:   42 | 4500002b 00000000 64062a41 121a042c 121a042d 09120016 000003e9 000f4629 50000000 52a30000 7468
OUTR:   41 | 4500002c 00000000 64062a40 121a042c 121a042d 09120016 000003ec 000f4629 50000000 53330000 61
OUTR: 10.000000: 18.26.4.44.2322 > 18.26.4.45.22: . 1001:1004(3,42,43) win 0
OUTR: 11.000000: 18.26.4.44.2322 > 18.26.4.45.22: . 1004:1008(4,41,44) win 0
Map SEQ 1001 -> 1001
Map SEQ 1004 -> 1003
OUT:   42 | 4500002a 00000000 64062a42 121a042c 121a042d 09120016 000003e9 000f4629 50000000 bba40000 7468
OUT:   41 | 45000029 00000000 64062a43 121a042c 121a042d 09120016 000003eb 000f4629 50000000 cf0b0000 61
OUT: 10.000000: 18.26.4.44.2322 > 18.26.4.45.22: . 1001:1003(2,42,42) win 0
OUT: 11.000000: 18.26.4.44.2322 > 18.26.4.45.22: . 1003:1004(1,41,41) win 0
TX:   40 | 45000028 00000000 fa069443 121a042d 121a042c 00160912 000f4629 000003eb 5010f000 3ffc0000
TX:   40 | 45000028 00000000 fa069443 121a042d 121a042c 00160912 000f4629 000003ec 5010f000 3ffb0000
TX: 10.000000: 18.26.4.45.22 > 18.26.4.44.2322: . 1001001:1001001(0,40,40) ack 1003 win 61440
TX: 11.000000: 18.26.4.45.22 > 18.26.4.44.2322: . 1001001:1001001(0,40,40) ack 1004 win 61440
Map ACK 1003 -> 1005
Map ACK 1004 -> 1008
Map SEQ 1001001 -> 1001001
Map SEQ 1001001 -> 1001001
TXOUT: 10.000000: 18.26.4.45.22 > 18.26.4.44.2322: . 1001001:1001001(0,40,40) ack 1005 win 61440
TXOUT: 11.000000: 18.26.4.45.22 > 18.26.4.44.2322: . 1001001:1001001(0,40,40) ack 1008 win 61440
IN:   44 | 4500002c 00000000 64062a40 121a042c 121a042d 09120016 000003f0 000f4629 50000000 6d2c0000 61636174
RX: 12.000000: 18.26.4.44.2322 > 18.26.4.45.22: . 1008:1012(4,44,44) win 0
RXTCP: 12.000000: 18.26.4.44.2322 > 18.26.4.45.22: . 1008:1012(4,44,44) win 0
OUTR:   44 | 4500002c 00000000 64062a40 121a042c 121a042d 09120016 000003f0 000f4629 50000000 6d2c0000 61636174
OUTR: 12.000000: 18.26.4.44.2322 > 18.26.4.45.22: . 1008:1012(4,44,44) win 0
Map SEQ 1008 -> 1004
OUT:   44 | 4500002c 00000000 64062a40 121a042c 121a042d 09120016 000003ec 000f4629 50000000 6d300000 61636174
OUT: 12.000000: 18.26.4.44.2322 > 18.26.4.45.22: . 1004:1008(4,44,44) win 0
TX:   40 | 45000028 00000000 fa069443 121a042d 121a042c 00160912 000f4629 000003f0 5010f000 3ff70000
TX: 12.000000: 18.26.4.45.22 > 18.26.4.44.2322: . 1001001:1001001(0,40,40) ack 1008 win 61440
Map ACK 1008 -> 1012
Map SEQ 1001001 -> 1001001
TXOUT: 12.000000: 18.26.4.45.22 > 18.26.4.44.2322: . 1001001:1001001(0,40,40) ack 1012 win 61440
IN:   42 | 4500002a 00000000 64062a42 121a042c 121a042d 09120016 000003f4 000f4629 50000000 c68e0000 6973
RX: 13.000000: 18.26.4.44.2322 > 18.26.4.45.22: . 1012:1014(2,42,42) win 0
RXTCP: 13.000000: 18.26.4.44.2322 > 18.26.4.45.22: . 1012:1014(2,42,42) win 0
Adding modification at seq 1012, pos in content 0, seq+pos 1012, removing 2 bytes
OUTR:   40 | 4500002a 00000000 64062a42 121a042c 121a042d 09120016 000003f4 000f4629 50000000 c68e0000
OUTR: 13.000000: 18.26.4.44.2322 > 18.26.4.45.22: . 1012:1014(2,40,42) win 0
Map SEQ 1012 -> 1008
OUT:   40 | 45000028 00004000 ff064f43 121a042d 121a042c 00160912 000f4629 000003f6 5010f000 3ff10000
OUT: 0.000000: 18.26.4.45.22 > 18.26.4.44.2322: . 1001001:1001001(0,40,40) ack 1014 win 61440
Unknown ignored
OUT:   40 | 45000028 00000000 64062a44 121a042c 121a042d 09120016 000003f0 000f4629 50000000 30080000
OUT: 13.000000: 18.26.4.44.2322 > 18.26.4.45.22: . 1008:1008(0,40,40) win 0
Unknown ignored
IN:   50 | 45000032 00000000 64062a3a 121a042c 121a042d 09120016 000003f6 000f4629 50000000 24d20000 62656175 74696675 6c6c
RX: 14.000000: 18.26.4.44.2322 > 18.26.4.45.22: . 1014:1024(10,50,50) win 0
RXTCP: 14.000000: 18.26.4.44.2322 > 18.26.4.45.22: . 1014:1024(10,50,50) win 0
OUTR:   50 | 45000032 00000000 64062a3a 121a042c 121a042d 09120016 000003f6 000f4629 50000000 24d20000 62656175 74696675 6c6c
OUTR: 14.000000: 18.26.4.44.2322 > 18.26.4.45.22: . 1014:1024(10,50,50) win 0
Map SEQ 1014 -> 1008
OUT:   50 | 45000032 00000000 64062a3a 121a042c 121a042d 09120016 000003f0 000f4629 50000000 24d80000 62656175 74696675 6c6c
OUT: 14.000000: 18.26.4.44.2322 > 18.26.4.45.22: . 1008:1018(10,50,50) win 0
TX:   40 | 45000028 00000000 fa069443 121a042d 121a042c 00160912 000f4629 000003fa 5010f000 3fed0000
TX: 14.000000: 18.26.4.45.22 > 18.26.4.44.2322: . 1001001:1001001(0,40,40) ack 1018 win 61440
Map ACK 1018 -> 1024
Map SEQ 1001001 -> 1001001
TXOUT: 14.000000: 18.26.4.45.22 > 18.26.4.44.2322: . 1001001:1001001(0,40,40) ack 1024 win 61440
IN:   40 | 45000028 00000000 64062a44 121a042c 121a042d 09120016 00000400 000f4629 50010000 2ff70000
RX: 15.000000: 18.26.4.44.2322 > 18.26.4.45.22: F 1024:1025(1,40,40) win 0
RXTCP: 15.000000: 18.26.4.44.2322 > 18.26.4.45.22: F 1024:1025(1,40,40) win 0
OUTR:   40 | 45000028 00000000 64062a44 121a042c 121a042d 09120016 00000400 000f4629 50010000 2ff70000
OUTR: 15.000000: 18.26.4.44.2322 > 18.26.4.45.22: F 1024:1025(1,40,40) win 0
Map SEQ 1024 -> 1018
OUT:   40 | 45000028 00000000 64062a44 121a042c 121a042d 09120016 000003fa 000f4629 50010000 2ffd0000
OUT: 15.000000: 18.26.4.44.2322 > 18.26.4.45.22: F 1018:1019(1,40,40) win 0
TX:   40 | 45000028 00000000 fa069443 121a042d 121a042c 00160912 000f4629 000003fb 5011f000 3feb0000
TX: 15.000000: 18.26.4.45.22 > 18.26.4.44.2322: F 1001001:1001002(1,40,40) ack 1019 win 61440
Map ACK 1019 -> 1025
Map SEQ 1001001 -> 1001001
TXOUT: 15.000000: 18.26.4.45.22 > 18.26.4.44.2322: F 1001001:1001002(1,40,40) ack 1025 win 61440
